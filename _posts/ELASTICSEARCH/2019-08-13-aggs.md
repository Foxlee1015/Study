---
layout: post
title: Elasticsearch(aggs)
categories: ELASTICSEARCH

---


# Histogram Aggregationedit
* Histogram : 조건에 부합하는 documents 를 buckets 이라는 저장소 단위에 구분해 담아 새 집합 생성
* A multi-bucket values source based aggregation that can be applied on numeric values extracted from the documents. 
* It dynamically builds fixed size (a.k.a. interval) buckets over the values. 
* For example, if the documents have a field that holds a price (numeric), we can configure this aggregation to dynamically build buckets with interval 5 (in case of price it may represent $5). 
* When the aggregation executes, the price field of every document will be evaluated and will be rounded down to its closest bucket - for example, if the price is 32 and the bucket size is 5 then the rounding will yield 30 and thus the document will "fall" into the bucket that is associated with the key 30. 
The interval must be a positive decimal, while the offset must be a decimal in [0, interval) (a decimal greater than or equal to 0 and less than interval)

The following snippet "buckets" the products based on their price by interval of 50:

        POST /sales/_search?size=0
        {
            "aggs" : {
                "prices" : {
                    "histogram" : {
                        "field" : "price",
                        "interval" : 50
                    }
                }
            }
        }
        
        
         {
            ...
            "aggregations": {
                "prices" : {
                    "buckets": [
                        {
                            "key": 0.0,
                            "doc_count": 1
                        },
                        {
                            "key": 50.0,
                            "doc_count": 1
                        },
                        {
                            "key": 100.0,
                            "doc_count": 0
                        },
                        {
                            "key": 150.0,
                            "doc_count": 2
                        },
                        {
                            "key": 200.0,
                            "doc_count": 3
                        }
                    ]
                }
            }
        }
